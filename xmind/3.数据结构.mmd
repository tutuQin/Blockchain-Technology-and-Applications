flowchart LR
    A["03-BTC-数据结构"] --> B["一、课程主旨"] & H["二、交易数据结构（Transaction）"] & AC["三、区块结构（Block）"] & AT["四、Merkle 树（Merkle Tree）"] & BN["五、链式结构（Blockchain）"] & CD["六、结论"]
    B --> C["解释比特币数据的组织方式"] & D["重点：交易结构、区块结构、Merkle 树"] & E["目标：用数据结构 + 哈希实现"]
    E --> F["不可篡改性（Tamper-proof）"] & G["可验证性（Verifiability）"]
    H --> I["交易组成"] & O["UTXO 模型"] & T["例子"] & Z["不可篡改性来源（交易层）"]
    I --> J["输入列表（Inputs）"] & K["输出列表（Outputs）"] & L["金额"] & M["锁定脚本（ScriptPubKey）"] & N["解锁脚本（ScriptSig）"]
    O --> P["输入必须引用某笔已有交易的输出"] & Q["输出即“把钱给谁”"] & R["未花费输出构成 UTXO 集"] & S["验证方式：输入引用的输出必须存在且未被花费"]
    T --> U["A 收到 10 BTC → 想给 B 转 3 BTC"] & V["构造新交易"] & Y["好处：防双花、简化验证"]
    V --> W["输入：引用之前的 10 BTC 输出"] & X["输出：3 BTC 给 B，7 BTC 找零给 A"]
    Z --> AA["输入引用固定的旧输出 → 改一笔会牵动整个链"] & AB["哈希绑定（交易 ID）"]
    AC --> AD["区块体（Block Body）"] & AF["区块头（Block Header）"] & AM["不可篡改性来源（区块层）"] & AQ["可验证性来源（区块层）"]
    AD --> AE["包含本区块的全部交易列表"]
    AF --> AG["版本号"] & AH["前一个区块哈希（Prev Hash）"] & AI["Merkle 根哈希（Merkle Root）"] & AJ["时间戳"] & AK["难度目标"] & AL["Nonce"]
    AM --> AN["前一个区块哈希将所有区块串成链"] & AO["改动任意历史区块 → 所有后续区块哈希失效"] & AP["需要重做所有后续区块的 PoW"]
    AQ --> AR["节点只需下载区块头即可快速验证链的工作量"] & AS["抽查交易 + Merkle 路径即可验证真实性"]
    AT --> AU["定义"] & AY["Merkle 根（Merkle Root）"] & BA["用途"] & BE["Merkle Proof（包含性证明）"] & BJ["不可篡改性来源（交易集合层）"]
    AU --> AV["二叉哈希树"] & AW["叶子节点：每笔交易的哈希"] & AX["父节点：左右孩子哈希拼接再哈希"]
    AY --> AZ["一个固定长度的哈希，代表所有交易"]
    BA --> BB["压缩大量交易（固定大小）"] & BC["快速包含性证明（Merkle Proof）"] & BD["局部检测篡改"]
    BE --> BF["钱包要证明“交易 X 包含在某区块”"] & BG["节点提供：从 X 到根路径的所有兄弟节点哈希"] & BH["钱包重新计算路径得到 Root"] & BI["若与区块头一致 → 证明交易已被写入区块"]
    BJ --> BK["改任何一笔交易 → 叶子哈希改变"] & BL["导致路径上所有父节点哈希改变"] & BM["最终 Root 改变 → 区块头哈希改变 → 链断"]
    BN --> BO["核心链式关系"] & BT["不可篡改性（最终效果）"] & BY["可验证性（对新节点）"]
    BO --> BP["交易引用旧输出（链）"] & BQ["交易集合用 Merkle 树（树）"] & BR["区块用前区块哈希链接（链）"] & BS["区块头通过 PoW 加固（难以伪造）"]
    BT --> BU["改早期交易 = 重算该区块的 Merkle Root"] & BV["= 重算区块头哈希"] & BW["= 重算所有后续区块哈希"] & BX["= 重做整个链的 PoW → 成本极高"]
    BY --> BZ["验证区块头哈希满足难度"] & CA["验证区块之间的 Prev Hash 链接"] & CB["抽查部分交易 + Merkle 路径"] & CC["无需信任任何中心机构"]
    CD --> CE["比特币账本可信不是因为“中心化机构”"] & CF["而是因为：交易结构 + 区块结构 + Merkle 树"] & CG["再加上哈希函数和 PoW → 篡改成本极高"] & CH["数据结构本身就保证了“公开网络中的信任”"]