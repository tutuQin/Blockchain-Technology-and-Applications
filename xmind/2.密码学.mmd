flowchart LR
    A["比特币的两大密码学支柱"] --> B["一、密码学在比特币中的角色"]
    B --> J["二、哈希函数（Hash）"] & C["开放网络，不信任中心"] & D["四大问题"] & I["类比：QQ群转账依赖数学可信"]
    J --> U["三、基于哈希的数据结构"] & K["特性"] & L["在比特币中的作用"] & M["示例：10 → 11，哈希完全变化"]
    U --> AI["四、公钥密码学（PKC）"] & N["哈希指针 Hash Pointer"] & O["Merkle Tree"] & P["Merkle Proof"] & Q["Binary Tree vs Merkle Tree"]
    AI --> AU["五、安全性：为何能防伪、防篡改、防冒充"] & R["密钥对"] & S["地址（公钥多重哈希生成）"] & T["数字签名"] & V["示例：签名交易 → 全网验证"]
    AU --> BD["六、总结"] & W["防伪造"] & X["防篡改"] & Y["防冒充"] & Z["数学 + 广播网络 = 去中心化信任"]
    D --> D1["保密性"] & D2["防篡改"] & D3["身份认证"] & D4["不可否认性"]
    K --> K1["单向性（Preimage Resistance）"] & K2["抗碰撞性（Collision Resistance）"] & K3["雪崩效应"]
    L --> L1["交易 ID"] & L2["区块 ID"] & L3["哈希指针 Hash Pointer（形成区块链）"] & L4["Merkle Root（交易集合哈希）"]
    N --> N1["存储：地址 + 哈希"] & N2["形成防篡改日志（tamper-evident log）"]
    O --> O1["叶子节点：交易哈希"] & O2["父节点：左右子节点拼接后哈希"] & O3["Root Hash → 记录在区块头"] & O4["任何改动会改变 Root"]
    P --> P1["Proof of Inclusion（包含证明）"] & P2["Proof of Membership（成员证明）"] & P3["Proof of Non-membership（非成员证明）"]
    Q --> Q1["Binary Tree：无哈希，不能证明数据完整性"] & Q2["Merkle Tree：可验证、可证明、可抗篡改"]
    R --> R1["私钥：签名"] & R2["公钥：验证"]
    S --> S1["安全、短"] & S2["无法反向推算私钥"] & S3["可用于收款"]
    T --> T1["只能私钥持有者产生"] & T2["全网可验证"]
    W --> W1["无法伪造签名"]
    X --> X1["改交易 → 签名失效"] & X2["改区块 → 哈希链断裂"]
    Y --> Y1["只有私钥持有者能花币"]
    BD --> BE["哈希 → 完整性、不可篡改性"] & BF["签名 → 身份认证、不可否认性"] & BG["两者结合 → 信任最小化账本"] & BH["哈希链 + 签名 + 广播 = 比特币安全基石"]